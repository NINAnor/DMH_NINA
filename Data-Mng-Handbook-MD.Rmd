---
title: "S-ENDA Data management handbook"
subtitle: ''
output:
  html_document:
      toc: yes
      toc_float: 
        collapsed: TRUE
      df_print: paged
  md_document:
    variant: markdown_github
runtime: shiny_prerendered
---

# Introduction

This handbook describes general data management practices of the S-ENDA partners:

- Norwegian Meteorological Institute (Meteorologisk institutt - MET)
- Norwegian Institute for Air Research (Norsk institutt for luftforskning - NILU)
- Norwegian Institute for Nature Research (Norsk institutt for naturforskning - NINA)
- Norwegian Institute for Water Research (Norsk institutt for vannforskning - NIVA)

This handbook focuses on the management and sharing of dynamical geodata in line with the FAIR (Findable, Accessible, Interoperable, and Reusable) guiding principles for scientific data management. 

## About S-ENDA 

S-ENDA is part of a larger effort within the national geodata strategy (“Alt skjer et sted”), and relates to this strategy through Geonorge, which is developed and operated by the Norwegian Mapping Authority (“Kartverket”). GeoNorge, in turn, relates to the European Inspire Geoportal through the Inspire directive. In particular, S-ENDA is responsible for Action 20 of the Norwegian geodata strategy. The goal of action 20 is to establish a distributed, virtual data center for use and management of dynamic geodata. S-ENDA’s vision is that everyone, from professional users to the general public, should have easy, secure and stable access to dynamic geodata.

The vision of S-ENDA and the goal of action 20 are aligned with international guidelines, in particular the FAIR Guiding Principles for scientific data management and stewardship.
S-ENDA in a national and international context

Dynamic geodata is weather, environment and climate-related data that changes in space and time and is thus descriptive of processes in nature. Examples are weather observations, weather forecasts, pollution (environmental toxins) in water, air and sea, information on the drift of cod eggs and salmon lice, water flow in rivers, driving conditions on the roads and the distribution of sea ice. Dynamic geodata provides important constraints for many decision-making processes and activities in society.

Geonorge is the national website for map data and other location information in Norway. Here, users of map data can search and access such information. Dynamic geodata is one such information type. S-ENDA extends Geonorge by taking responsibility for harmonising the management of dynamic geodata in a consistent manner.

```{r, include=FALSE}
knitr::opts_chunk$set(echo=FALSE)

```


```{r, context="setup", include=FALSE}

require(shiny)
require(dplyr)
require(rhandsontable)
require(openxlsx)
require(DT)
require(data.table)
require(htmltools)

filename = "FAIR.xlsx"

variable =  getSheetNames(filename)

for (i in 1:length(variable)) {
 
  VarName  =  read.xlsx(filename, sheet = variable[i],
                        fillMergedCells  = TRUE)
  
  # if (VarName$Link[i]!= is.na(VarName$Link[i])){
  #   
  #   test = paste0("[test]","(",VarName$Link[i],")")
  # }
  
  assign(variable[i], VarName) 
  

    
}

FairDT =  FAIR %>%
  mutate(Check = FALSE,
         Score = 0.0)



```

## Contacts and roles 

```{r}
datatable(Role)
```


Here is a list of relevant contacts

# Practical guides

## Create a Data Management Plan (DMP)

The funding agency of your project will usually provide requirements, guidelines or a template for the DMP. If this is not the case, Science Europe offers a comprehensive [Practical guide of research data management](https://www.forskningsradet.no/contentassets/e4cd6d2c23cf49d4989bb10c5eea087a/se_rdm_practical_guide_final.pdf).

For researchers with no or little experience in data management, a simple way of creating a DMP is with [EasyDMP](https://www.sigma2.no/data-planning)

### Using easyDMP

1. Log in to easyDMP, use Dataporten if your institution supports that, otherwise pick one of the other login methods.

2. Click on + Create a new plan and pick a template

3. By using the Summary button from page two and on, you can get an overview of all the questions.

*Publishing the plan*

Currently you can use the export function in easyDMP to download an HTML or PDF version of the DMP and use it further. This might change if "Hosted DMP" gets implemented.



# Check if your dataset is FAIR

```{r, context="render", echo = FALSE}
fluidPage(

  downloadButton("downloadData", "Download FAIR table"),
  br(), p(),
  
 rHandsontableOutput("hottable"))

 

```



```{r, context = 'server'}
values <- reactiveVal()
    


       output$hottable <- renderRHandsontable({
         if (all(values()$Check == 0)) {
           FairDT = FairDT
         }
         
         
         else {
           displaytbls <- data.table::data.table(values())
           FairDT = displaytbls
           
           
           
           for (i in 1:nrow(FairDT)) {
             if (FairDT$Check[i]) {
               FairDT$Score[i] = 100/nrow(FairDT)
              FairDT$Total[nrow(FairDT)]  = sum(FairDT$Score)
               
               
             }
             
           }
           
         }
      
         rhandsontable(FairDT) %>%
           
           hot_col(
             col = "Score",
             source =  "Score",
             readOnly = TRUE,
             renderer = "
          function (instance, td, row, col, prop, value, cellProperties) {
             Handsontable.renderers.NumericRenderer.apply(this, arguments);
             if (value > 0) {
              td.style.background = 'lightgreen';
                           }
           }"
           ) %>%
           hot_col(
             col = "Total",
             source =  "Total",
             renderer = "
          function (instance, td, row, col, prop, value, cellProperties) {
             Handsontable.renderers.NumericRenderer.apply(this, arguments);
           if (value < 5 ) {
              td.style.background = 'grey';}
            if (value > 5 && value < 20) {
              td.style.background = 'pink';}
      if (value >= 20 && value < 50) {
              td.style.background = 'yellow';}
      if (value > 50) {
              td.style.background = 'lightgreen';}

      }
      "
           )
    

  })

  
    observeEvent(input$hottable, {
      values(hot_to_r(input$hottable))

   })
  #  

 
 output$downloadData <- downloadHandler(filename = function() { 
    return(paste('FAIR_check.xlsx'))

 }, content = function(file) {
   write.xlsx(FairDT, file)
 })

```

# Practical guides


# References 

# Glossary of Terms and Names

```{r}
datatable(Glossary)
```

## Metadata types

Metadata is a broad concept. In our data management model the term "metadata" is used in several contexts, specifically the five categories that are briefly described in Table 1.


```{r}
datatable(Metadata)

```
# List of acronyms 

```{r}
datatable(Acronyms)
```








